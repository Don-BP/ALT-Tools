<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Power - ALT Classroom Tools</title>
    <link rel="stylesheet" href="style.css">
    <!-- Placeholder for theme stylesheets, controlled by JS -->
    <link id="scoreboard-theme-stylesheet" rel="stylesheet" href="">
</head>
<body>

    <header>
        <h1>Brain Power ALT Classroom Tools</h1>
        <p>Simple tools to make your lessons great!</p>
        <button id="mute-btn" title="Toggle Sound">üîä</button>
    </header>

    <div class="tool-container">
        <!-- Date & Weather -->
        <div class="tool-card" id="date-weather-tool">
            <h2>Date & Weather</h2>
            <div class="dw-main-content">
                <div class="dw-left-panel">
                    <div class="dw-calendar-nav">
                        <button id="dw-prev-month-btn"><</button>
                        <h3 id="dw-calendar-header">Month Year</h3>
                        <button id="dw-next-month-btn">></button>
                    </div>
                    <div id="dw-calendar-grid">
                        <!-- Calendar will be generated by JS -->
                    </div>
                </div>
                <div class="dw-right-panel">
                    <!-- These elements are visible only in fullscreen -->
                    <div id="dw-month-display">Month</div>
                    <div class="dw-day-date-row">
                        <div id="dw-day-display">Day</div>
                        <div id="dw-date-display">Date</div>
                    </div>
                    <!-- This row groups time and weather for layout -->
                    <div class="dw-time-weather-row">
                        <div id="dw-time-display">00:00:00</div>
                        <div id="dw-weather-display">
                            <div class="dw-weather-controls">
                                <label for="dw-weather-select">Weather:</label>
                                <select id="dw-weather-select">
                                    <option value="sunny">Sunny</option>
                                    <option value="cloudy">Cloudy</option>
                                    <option value="rainy">Rainy</option>
                                    <option value="windy">Windy</option>
                                    <option value="snowy">Snowy</option>
                                    <option value="stormy">Stormy</option>
                                </select>
                            </div>
                            <img id="dw-weather-img" src="assets/weather/sunny.png" alt="Sunny">
                            <div id="dw-weather-text">Sunny</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Random Name Picker -->
        <div class="tool-card">
            <h2>Random Name Picker</h2>
            <div class="fireworks-container" id="name-picker-fireworks"></div>
            <div class="name-picker-content">
                <div class="name-picker-panel">
                    <div class="class-list-manager">
                        <label for="class-list-select">Load Class:</label>
                        <select id="class-list-select">
                            <option value="">-- New List --</option>
                        </select>
                        <button id="delete-class-btn" title="Delete Selected Class">üóëÔ∏è</button>
                    </div>
                    <textarea id="name-list" placeholder="Paste student names here, one per line..."></textarea>
                    <div class="name-picker-controls">
                        <button id="save-class-btn">Save List</button>
                        <button id="pick-name-btn">Pick a Student!</button>
                    </div>
                    <div class="name-picker-options">
                        <input type="checkbox" id="dont-pick-again-check">
                        <label for="dont-pick-again-check">Don't pick again until list is reset</label>
                    </div>
                    <div id="picked-names-container" class="hidden">
                        <h4>Already Picked:</h4>
                        <ul id="picked-names-list"></ul>
                    </div>
                </div>
                <div id="picked-name"></div>
            </div>
        </div>

        <!-- Classroom Timer -->
        <div class="tool-card">
            <h2>Classroom Timer</h2>
            <div class="timer-layout-container">
                <div class="timer-controls-panel">
                    <div id="timer-display">05:00</div>
                    <div class="preset-timers">
                        <button class="preset-btn" data-time="60">1 min</button>
                        <button class="preset-btn" data-time="300">5 min</button>
                        <button class="preset-btn" data-time="600">10 min</button>
                    </div>
                    <div class="timer-controls">
                        <button id="timer-start-stop">Start</button>
                        <button id="timer-reset">Reset</button>
                    </div>
                    <div class="timer-theme-selector">
                        <label for="timer-theme">Theme:</label>
                        <select id="timer-theme">
                            <option value="bar" selected>Progress Bar</option>
                            <option value="bucket">Water Bucket</option>
                        </select>
                    </div>
                </div>
                <div class="timer-visual-container">
                    <div id="timer-theme-bar" class="timer-theme active">
                        <div id="timer-progress-bar">
                            <div id="timer-progress"></div>
                        </div>
                    </div>
                    <div id="timer-theme-bucket" class="timer-theme">
                        <div class="bucket-container">
                            <div class="water"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Digital Flashcards -->
        <div class="tool-card">
            <h2>Digital Flashcards</h2>
            <div class="flashcard-controls">
                <label for="flashcard-category">Category:</label>
                <select id="flashcard-category"></select>
            </div>
            <div id="flashcard-display-container">
                <div id="flashcard-display">
                    <div class="flashcard-face flashcard-front">Select a category</div>
                    <div class="flashcard-face flashcard-back"></div>
                </div>
            </div>
            <div class="flashcard-nav">
                <button id="flashcard-prev">Previous</button>
                <button id="flashcard-random">Random</button>
                <button id="flashcard-next">Next</button>
            </div>
        </div>

        <!-- Simple Scoreboard -->
        <div class="tool-card" id="scoreboard-tool">
            <h2>Simple Scoreboard</h2>

            <!-- Original scoreboard for grid view -->
            <div class="scoreboard-grid-view">
                <div class="scoreboard-teams">
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team1-avatar" alt="Team 1 Avatar">
                            <input type="file" class="avatar-upload-input" id="team1-avatar-upload" data-team="1" accept="image/*">
                            <label for="team1-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team1-name" contenteditable="true">Team 1</h3>
                        <div class="team-score" id="score-team1">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="1" data-amount="1">+</button>
                            <button class="score-btn" data-team="1" data-amount="-1">-</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team2-avatar" alt="Team 2 Avatar">
                            <input type="file" class="avatar-upload-input" id="team2-avatar-upload" data-team="2" accept="image/*">
                            <label for="team2-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team2-name" contenteditable="true">Team 2</h3>
                        <div class="team-score" id="score-team2">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="2" data-amount="1">+</button>
                            <button class="score-btn" data-team="2" data-amount="-1">-</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team3-avatar" alt="Team 3 Avatar">
                            <input type="file" class="avatar-upload-input" id="team3-avatar-upload" data-team="3" accept="image/*">
                            <label for="team3-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team3-name" contenteditable="true">Team 3</h3>
                        <div class="team-score" id="score-team3">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="3" data-amount="1">+</button>
                            <button class="score-btn" data-team="3" data-amount="-1">-</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team4-avatar" alt="Team 4 Avatar">
                            <input type="file" class="avatar-upload-input" id="team4-avatar-upload" data-team="4" accept="image/*">
                            <label for="team4-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team4-name" contenteditable="true">Team 4</h3>
                        <div class="team-score" id="score-team4">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="4" data-amount="1">+</button>
                            <button class="score-btn" data-team="4" data-amount="-1">-</button>
                        </div>
                    </div>
                </div>
                <button id="reset-scores">Reset Scores</button>
            </div>

            <!-- New themed scoreboard for fullscreen view -->
            <div id="themed-scoreboard-container" class="hidden">
                 <div class="scoreboard-fullscreen-controls">
                    <div class="sb-control-group">
                        <label>Teams:</label>
                        <button id="sb-remove-team-btn" title="Remove Team">-</button>
                        <span id="sb-team-count-display">4</span>
                        <button id="sb-add-team-btn" title="Add Team">+</button>
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-theme-select">Theme:</label>
                        <select id="sb-theme-select">
                            <option value="default">Default</option>
                            <option value="star-jar">Star Jar</option>
                            <option value="spring">Spring</option>
                            <option value="science">Science</option>
                            <option value="music">Music</option>
                            <option value="halloween">Halloween</option>
                            <option value="christmas">Christmas</option>
                            <option value="animals">Animals</option>
                            <option value="minimalist">Minimalist</option>
                            <option value="energy-bar">Energy Bar</option>
                        </select>
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-win-score-input">Win Score:</label>
                        <input type="number" id="sb-win-score-input" min="1" value="20">
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-bonus-input">Points:</label>
                        <input type="number" id="sb-bonus-input" min="1" value="1">
                    </div>
                    <div class="sb-control-group">
                        <button id="sb-reset-btn">Reset All</button>
                    </div>
                </div>
                <div id="themed-teams-container">
                    <!-- Themed teams will be dynamically inserted here by JS -->
                </div>
            </div>

            <!-- Winner Popup and Confetti Canvas (for fullscreen) -->
            <div id="winner-popup" class="hidden">
                <div class="winner-popup-content">
                    <button class="winner-popup-close">‚úñ</button>
                    <!-- ADD THE IMAGE ELEMENT HERE -->
                    <img src="" alt="Winner's Avatar" id="winner-team-avatar" class="winner-avatar">
                    <h2>üéâ WINNER! üéâ</h2>
                    <p id="winner-team-name"></p>
                </div>
            </div>
            <canvas id="confetti-canvas"></canvas>

        </div>
        
        <!-- What's Missing? Game -->
        <div class="tool-card">
            <h2>What's Missing? Game</h2>
            <div class="wm-settings">
                <div class="flashcard-controls">
                    <label for="whats-missing-category">Category:</label>
                    <select id="whats-missing-category"></select>
                </div>
                <div class="flashcard-controls">
                    <label for="whats-missing-difficulty">Difficulty:</label>
                    <select id="whats-missing-difficulty">
                        <option value="easy">Easy (6s)</option>
                        <option value="normal" selected>Normal (4s)</option>
                        <option value="hard">Hard (2.5s)</option>
                    </select>
                </div>
                <div class="flashcard-controls">
                    <label for="wm-card-count">Cards:</label>
                    <select id="wm-card-count">
                        <option value="4">4</option>
                        <option value="6" selected>6</option>
                        <option value="9">9</option>
                    </select>
                </div>
                <div class="flashcard-controls">
                    <label for="wm-missing-count">Missing:</label>
                    <select id="wm-missing-count">
                        <option value="1" selected>1 Card</option>
                        <option value="2">2 Cards</option>
                        <option value="3">3 Cards</option>
                        <option value="4">4 Cards</option>
                    </select>
                </div>
            </div>
            <div id="whats-missing-status">Select a category and start the game!</div>
            <div class="whats-missing-grid" id="whats-missing-grid"></div>
            <button id="whats-missing-start-btn">Start Game</button>
        </div>

        <!-- Image Reveal Game -->
        <div class="tool-card" id="image-reveal-tool">
            <h2>Image Reveal Game</h2>
            <div class="ir-setup-controls">
                <input type="file" id="ir-image-input" accept="image/*" class="hidden" multiple>
                <label for="ir-image-input" class="button-like-label">Upload Image(s)</label>
                <div class="ir-option">
                    <label for="ir-grid-size">Grid:</label>
                    <select id="ir-grid-size">
                        <option value="3x2">Easy (3x2)</option>
                        <option value="5x4" selected>Normal (5x4)</option>
                        <option value="8x6">Hard (8x6)</option>
                        <option value="10x8">Expert (10x8)</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="ir-custom-grid-inputs hidden">
                    <input type="number" id="ir-custom-cols" placeholder="Cols" min="1" max="30" value="5"> x
                    <input type="number" id="ir-custom-rows" placeholder="Rows" min="1" max="30" value="4">
                </div>
                <div class="ir-option">
                    <label for="ir-reveal-mode">Mode:</label>
                    <select id="ir-reveal-mode">
                        <option value="manual" selected>Manual</option>
                        <option value="auto">Automatic (2s)</option>
                        <option value="custom">Custom Speed</option>
                    </select>
                </div>
                 <div class="ir-custom-speed-input hidden">
                    <input type="number" id="ir-custom-speed" placeholder="Sec" min="0.1" step="0.1" value="2"> s
                </div>
            </div>
            <div class="ir-game-controls">
                <button id="ir-start-pause-btn" class="hidden">Start</button>
                <button id="ir-manual-reveal-btn" class="hidden">Reveal Tile</button>
                <button id="ir-reveal-all-btn" class="hidden">Reveal All</button>
                <button id="ir-reset-grid-btn" class="hidden">Reset Grid</button>
                <button id="ir-next-image-btn" class="hidden">Next Image</button>
                <button id="ir-new-game-btn" class="hidden">New Game</button>
            </div>
            <div class="ir-game-area">
                <div id="ir-image-container">
                    <img id="ir-image" src="" alt="Image to be revealed">
                    <div id="ir-grid-overlay"></div>
                </div>
                 <div id="ir-status-bar">
                    <span id="ir-sequence-status"></span>
                    <span id="ir-game-status">Upload an image to begin!</span>
                </div>
            </div>
        </div>

        <!-- Bingo Picker -->
        <div class="tool-card" id="bingo-tool">
            <h2>Bingo Picker</h2>
            <div class="bingo-controls-panel">
                 <div class="bingo-source-select">
                    <label for="bingo-list-select">Use List From:</label>
                    <select id="bingo-list-select">
                        <option value="custom">-- Custom List Below --</option>
                        <!-- Populated by JS -->
                    </select>
                </div>
                <textarea id="bingo-list-input" placeholder="Or, enter items here, one per line..."></textarea>
                <div class="bingo-buttons">
                    <button id="bingo-pick-btn">Pick an Item</button>
                    <button id="bingo-reset-btn">Reset Game</button>
                </div>
            </div>
            <div class="bingo-display-area">
                <div id="bingo-picked-item-display">BINGO!</div>
                <div id="bingo-picked-container" class="hidden">
                    <h4>Already Picked:</h4>
                    <div id="bingo-picked-list"></div>
                </div>
            </div>
        </div>

        <!-- Activity Spinner -->
        <div class="tool-card" id="spinner-tool">
            <h2>Activity Spinner</h2>

            <!-- Grid View Content -->
            <div id="spinner-grid-view">
                <div class="config-section">
                    <div class="config-block">
                        <h3>Load from Flashcards</h3>
                        <select id="spinner-flashcard-select">
                            <option value="">-- Manual List --</option>
                        </select>
                    </div>
                     <div class="config-block">
                         <h3>Add/Remove Items</h3>
                         <div class="add-word-form">
                             <input type="text" id="spinner-word-input" placeholder="Enter word or phrase">
                             <input type="file" id="spinner-segment-image-input" accept="image/*" style="display: none;">
                             <label for="spinner-segment-image-input" class="upload-button small-upload-btn" title="Add image to this item">üñºÔ∏è</label>
                             <button id="spinner-add-word-button">Add</button>
                         </div>
                         <div id="spinner-segment-image-preview" class="image-preview-area"></div>
                         <h4>Current Items:</h4>
                         <ul id="spinner-word-list" class="word-list item-list"></ul>
                     </div>
                </div>
            </div>

            <!-- Fullscreen View Content (initially hidden) -->
            <div id="spinner-fullscreen-view" class="hidden">
                <div class="main-container">
                    <div class="spinner-section">
                        <button id="spinner-spin-button" class="spin-button-top">SPIN!</button>
                        <div class="spinner-container" id="spinner-container">
                            <div class="spinner-wheel" id="spinner-wheel"></div>
                        </div>
                        <div id="spinner-result-display" class="result-display" aria-live="polite"></div>
                    </div>
                    <div class="config-section">
                        <h2>Customize Spinner</h2>
                        
                        <div class="config-block">
                           <h3>Load & Manage Items</h3>
                           <select id="spinner-flashcard-select_fs">
                               <option value="">-- Manual List --</option>
                           </select>
                           <ul id="spinner-word-list_fs" class="word-list item-list" style="margin-top: 15px;">
                               <!-- Fullscreen list will be rendered here by JS -->
                           </ul>
                           <div class="add-word-form" style="margin-top: 15px;">
                               <input type="text" id="spinner-word-input_fs" placeholder="Enter word or phrase">
                               <input type="file" id="spinner-segment-image-input_fs" accept="image/*" style="display: none;">
                               <label for="spinner-segment-image-input_fs" class="upload-button small-upload-btn" title="Add image to this item">üñºÔ∏è</label>
                               <button id="spinner-add-word-button_fs">Add</button>
                           </div>
                           <div id="spinner-segment-image-preview_fs" class="image-preview-area"></div>
                        </div>

                         <div class="config-block">
                            <h3>Customize Caps</h3>
                            <input type="file" id="spinner-cap-image-upload" accept="image/*" style="display: none;">
                            <label for="spinner-cap-image-upload" class="upload-button">Upload Cap Image</label>
                            <button id="spinner-remove-cap-image" class="remove-button" style="display: none;">Remove Image</button>
                         </div>
                         <div class="config-block">
                            <h3>Adjust Text Size</h3>
                            <div class="font-size-control">
                                <label for="spinner-font-size-slider">Size:</label>
                                <input type="range" id="spinner-font-size-slider" min="8" max="30" value="18">
                                <span id="spinner-font-size-value">18px</span>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3D Dice Roller -->
        <div class="tool-card" id="dice-roller-tool">
            <h2>3D Dice Roller</h2>
            <div class="dice-roller-controls">
                <div class="dr-control-group">
                    <label for="dr-dice-count">Dice:</label>
                    <select id="dr-dice-count">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
                <button id="dr-roll-btn">Roll Dice!</button>
                <div class="dr-control-group">
                    <input type="file" id="dr-table-image-upload" class="hidden" accept="image/*">
                    <label for="dr-table-image-upload" class="button-like-label">Upload Table Image</label>
                    <button id="dr-remove-table-image-btn" class="hidden" style="background-color: #d9534f;">Remove Image</button>
                </div>
            </div>
            <div id="dice-canvas-container">
                <!-- 3D Canvas will be inserted here by JS -->
            </div>
            <div id="dice-result-popup" class="hidden">
                <div class="dice-result-content">
                    <h3>Total Roll:</h3>
                    <p id="dice-result-total">0</p>
                    <button id="dice-result-close-btn">Close</button>
                </div>
            </div>
        </div>

        <!-- Simple Whiteboard -->
        <div class="tool-card">
            <h2>Simple Whiteboard</h2>
            <div class="whiteboard-controls">
                <label for="wb-color">Color:</label>
                <input type="color" id="wb-color" value="#000000">
                <label for="wb-width">Width:</label>
                <input type="range" id="wb-width" min="1" max="50" value="5">
                <button id="wb-pen-btn" class="active">Pen</button>
                <button id="wb-eraser-btn">Eraser</button>
                <button id="wb-clear-btn">Clear</button>
                <button id="wb-undo-btn" disabled>Undo</button>
                <button id="wb-save-btn">Save Image</button>
            </div>
            <canvas id="whiteboard-canvas"></canvas>
        </div>

        <!-- Flashcard Manager -->
        <div class="tool-card">
            <h2>Flashcard Manager</h2>
            <div class="flashcard-manager-controls">
                <div class="fm-row">
                    <select id="fm-set-select"><option value="">-- Create New Set --</option></select>
                    <button id="fm-delete-set-btn">Delete Set</button>
                </div>
                <div class="fm-row">
                    <input type="text" id="fm-set-name" placeholder="New or Loaded Set Name">
                </div>
                <div class="fm-row">
                    <input type="text" id="fm-card-text" placeholder="Card Text (e.g., Dog)">
                    <input type="file" id="fm-card-img" accept="image/*">
                    <button id="fm-add-card-btn">Add Card</button>
                </div>
            </div>
            <p><strong>Cards in this set:</strong></p>
            <div id="fm-current-cards"></div>
            <button id="fm-save-set-btn">Save Set</button>
        </div>
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="js/main.js" type="module"></script>
</body>
</html>